# Mind Maps Workflow

Create radial mind maps with a central topic and branching ideas.

---

## Why Mind Maps Work

### The Brain is Associative
- Every thought connects to other memories automatically
- Linear note-taking fights this natural process; mind maps embrace it
- Neural networks connect related concepts - mind maps mirror this structure

### Visual Processing Power
- Brain processes visual information faster than sequential text
- Seeing relationships spatially enhances comprehension and recall
- Central placement + radiating pattern stimulates memory retention

### Hierarchical Organization
- Brain naturally structures data by importance and relationship
- Grouping related information simplifies understanding and memory
- Non-linear structure reflects how knowledge actually exists in the mind

---

## Core Principles

### 1. Central Nucleus
- Main idea in the **CENTER** of the page (not top)
- Everything radiates outward like neural connections
- Single keyword or image (not a sentence)

### 2. Hierarchical Branching
```
Level 0: Central Topic (the core concept)
    ↓
Level 1: Main Branches (primary divisions - 3-8 recommended)
    ↓
Level 2: Secondary Topics (key points within subtopics)
    ↓
Level 3: Detailed Ideas (specific details)
    ↓
Level 4: Finest Details (examples, elaborations)
```
Most mind maps go **3-4 levels deep** (not just 1-2).

### 3. Clockwise Flow
- Start at top/top-right (12 o'clock position)
- Move clockwise as you add main branches
- Consistency aids processing

### 4. Keywords Only
- Use **KEYWORDS** or **SHORT PHRASES** (not full sentences)
- A keyword triggers memory and associations
- "Budget" instead of "What is the budget for this project?"

### 5. Visual Differentiation
- **Colors:** Different color for each main branch
- **Branch Width:** Thicker lines = more important
- **Images/Symbols:** Icons enhance memory retention

### 6. Flexibility & Growth
- New information can be added without disrupting structure
- Easy to expand any branch deeper
- Adaptable to new insights

---

## When to Use

- Brainstorming and idea organization
- Book summaries and key takeaways
- Topic exploration and research
- Planning and goal setting
- Problem-solving (root problem → causes → solutions)
- Writing structure (fiction/non-fiction outline)
- Memory and exam prep

---

## Intelligent Content Analysis

**Before touching layout, Claude must THINK about the source material.**

### The Preview-Read-Map Cycle

When working with source material (books, articles, transcripts), follow this systematic approach:

**PREVIEW (30 seconds)**
- Skim introductions, headings, conclusions
- Identify the general structure and purpose
- Note bold/italic text, illustrations, summaries
- Form a mental outline of what you'll encounter

**READ (focus on structure)**
- Read thoroughly, but think in concepts, not sentences
- Ask: "How would I organize this visually?"
- Identify key points, summarize paragraphs into keywords
- Notice how ideas connect to each other

**MAP (transcribe intelligently)**
- Don't copy text - transform it into keywords
- Use words that trigger memory (not full explanations)
- Build hierarchy based on importance and relationship
- Let branches emerge naturally from the content

**REVIEW (validate structure)**
- Does the central topic capture the essence?
- Are main branches truly the primary divisions?
- Do sub-nodes add clarity or clutter?
- Is the balance right across branches?

---

### Step 1: Identify the Central Topic

The central node is the title or main subject:
- Book: "ATOMIC HABITS" or "ATOMIC HABITS\nby James Clear"
- Article: The headline or topic
- Concept: The main idea being explored

**Format:** ALL CAPS, optionally with author/subtitle on second line.

### Step 2: Extract Natural Categories

Look for the source's inherent structure:
- **Chapters/Sections** → Often become main branches
- **Repeated themes** → Patterns that appear multiple times
- **Before/After** → Transformation arcs
- **Problems/Solutions** → Cause-effect relationships
- **Principles/Applications** → Theory vs practice

**Aim for 5-8 main branches.** Fewer than 5 feels incomplete. More than 8 becomes cluttered.

### Step 3: Determine Hierarchy Depth

Not all content needs the same depth. Analyze each branch:

| Content Type | Recommended Depth | Why |
|--------------|-------------------|-----|
| Simple concept | 2 levels (branch → sub-nodes) | No further breakdown needed |
| Complex framework | 3-4 levels (branch → sub → sub-sub) | Needs unpacking |
| Actionable steps | 2-3 levels | Clear sequence |
| Philosophical insight | 2 levels | Over-explaining dilutes impact |

**Rule:** Go deeper when understanding requires it. Stop when adding more obscures rather than clarifies.

### Step 4: Categorize Each Piece of Content

For every insight, quote, or idea, determine its role:

| Category | Visual Treatment | Hierarchy Level |
|----------|------------------|-----------------|
| **Core Principle** | Branch node (prominent) | Level 1 |
| **Supporting Evidence** | Sub-node | Level 2 |
| **Specific Example** | Sub-sub-node | Level 3 |
| **Memorable Quote** | Sub-node with larger box | Level 2-3 |
| **Action Step** | Sub-node | Level 2-3 |
| **Definition/Clarification** | Sub-sub-node | Level 3-4 |

### Step 5: Build Relationship Chains

Mind maps aren't just hierarchies—they show how ideas connect.

**Ask for each sub-node:**
- Does this EXPLAIN the parent? (Definition → keep under parent)
- Does this EXTEND the parent? (Application → sub-sub-node)
- Does this CONTRAST with siblings? (Alternative view → same level)
- Does this CONNECT to another branch? (Cross-reference in text)

**Example chain:**
```
HABIT STACKING (Branch)
  ├── Link new habit to existing one (Principle)
  │     ├── "After I [CURRENT], I will [NEW]" (Formula)
  │     └── Morning coffee → journaling (Example)
  ├── Why it works (Supporting)
  │     └── Brain already has neural pathway (Explanation)
  └── Common mistakes (Contrast)
        ├── Stacking too many at once
        └── Choosing weak anchor habits
```

### Step 6: Balance Learning vs. Reference

**Learning mind map:** Fewer nodes, more whitespace, emphasizes core concepts. For: first-time understanding.

**Reference mind map:** More nodes, detailed examples, comprehensive. For: quick lookup.

**Ask the user which they need, or infer from context:**
- "Summarize this for me" → Learning
- "I need to remember everything" → Reference
- "Key takeaways" → Learning
- "Complete breakdown" → Reference

### Content Extraction Checklist

Before generating layout, confirm you have:

- [ ] Central topic (title/subject clearly stated)
- [ ] 5-8 main branches that cover all major themes
- [ ] Sub-nodes that explain or extend (not repeat) their parent
- [ ] Depth that matches complexity (simple = shallow, complex = deep)
- [ ] Keywords, not sentences (compress, don't copy)
- [ ] Balanced content across branches (no 1-node vs 10-node imbalance)

---

## Spacing & Node Decisions

### How Many Main Branches?

| Branch Count | Best For |
|--------------|----------|
| 3-4 | Simple concept, focused exploration |
| 5-7 | Standard complexity, most use cases |
| 8-10 | Comprehensive reference, book summary |
| 10+ | Consider splitting into multiple mind maps |

### How Deep Should Branches Go?

| Level | Contains | When to Use |
|-------|----------|-------------|
| Level 1 (branches) | Major themes/chapters | Always |
| Level 2 (sub-nodes) | Key concepts within themes | Almost always |
| Level 3 (sub-sub-nodes) | Specific details, examples | When understanding requires it |
| Level 4 (finest detail) | Quotes, elaborations | Rare - only for reference maps |

### When to Add Sub-Nodes of Sub-Nodes

Add deeper levels when:
- A concept has multiple distinct components
- Examples clarify an abstract principle
- The source material has natural nested structure
- A framework needs unpacking (steps within steps)

Do NOT add deeper levels when:
- You're just adding more words to the same idea
- The content could be combined into one sub-node
- It doesn't aid understanding

### Balance Test

If one branch has 8 sub-nodes and another has 1, something is wrong:
- Either the single-node branch is underdeveloped
- Or the 8-node branch should be split into 2-3 branches
- Aim for roughly equal content weight across branches

---

## Process

### 1. Gather Information

Ask the user:
- What's the central topic/theme?
- What are the main branches (3-8 recommended)?
- Any sub-points under each branch?

### 2. Plan the Layout

Describe the structure in plain language:
- "Central topic: [X]"
- "Right side branches (top to bottom): [A], [B], [C]"
- "Left side branches (top to bottom): [D], [E], [F]"
- "Sub-nodes for each branch: [list]"

### 3. Confirm with User

> "Here's the structure I'll create. Does this capture what you need?"

### 4. Generate Excalidraw JSON

Calculate positions and output valid Excalidraw JSON (see Layout section below).

---

## Layout Architecture

### Canvas Structure
- **Center point:** x=960, y=600 (middle of canvas)
- **Right side branches:** x > center (extend right)
- **Left side branches:** x < center (extend left)
- **Sub-nodes:** extend further outward from their parent branch

### Element Dimensions

| Element | Width | Height | Font Size |
|---------|-------|--------|-----------|
| Central node | 240px | 120px | 18px |
| Branch node | 200px | 60px | 16px |
| Sub-node (keyword) | 220px | 28px | 11px |
| Sub-node (phrase) | 400px | 40px | 14px |
| Sub-node (quote) | 400px | 56-88px | 12px |

### Sub-node Height Estimation

| Content Type | Height | When to Use |
|--------------|--------|-------------|
| Keyword (1-3 words) | 28px | Short principles |
| Short phrase (5-15 words) | 40px | One-liner insights |
| Quote (2 lines) | 56px | Multi-line text |
| Quote (3 lines) | 70px | Longer quotes |
| Quote (4+ lines) | 88px | Book passages |

**Formula:** `height = (line_count × 14) + 16`

---

## Layout Calculation

### Step 1: Analyze Content Volume
For each branch, calculate total height:
```
branch_height = 60px (branch node)
sub_node_height = sum of all sub-node heights
total_branch_height = branch_height + sub_node_height + gaps
```

### Step 2: Balance Sides
```
right_total = sum(branch_heights for right-side branches)
left_total = sum(branch_heights for left-side branches)
```

### Step 3: Calculate Center Position
```
max_side_height = max(right_total, left_total)
center_y = (max_side_height / 2) + top_margin
```

### Step 4: Position Branches
**Right side (top to bottom):**
- Branches: x = center_x + 260 to +320
- Sub-nodes: x = branch.x + 280

**Left side (top to bottom):**
- Branches: x = center_x - 460 to -520
- Sub-nodes: x = branch.x - sub_width - 80

### Step 5: Position Sub-nodes
```
y_cursor = branch.y - 30
For each sub_node:
  sub_node.y = y_cursor
  y_cursor += sub_node.height + 8px gap
```

---

## Color Scheme

| Element | Background | Stroke |
|---------|------------|--------|
| Central | `#ffc9c9` | `#e03131` |
| Branch 1 | `#a5d8ff` | `#1971c2` |
| Branch 2 | `#b2f2bb` | `#2f9e44` |
| Branch 3 | `#ffd8a8` | `#e8590c` |
| Branch 4 | `#d0bfff` | `#7950f2` |
| Branch 5 | `#fff3bf` | `#fab005` |
| Branch 6 | `#99e9f2` | `#0c8599` |

Sub-nodes use lighter shade of parent branch color.

---

## Arrow Connections (CRITICAL)

**Mind maps MUST have arrows connecting:**
1. Center node → Each main branch
2. Each main branch → Its sub-nodes

### Arrow Configuration

All mind map arrows should use `fixedPoint` for clean routing:
```json
{
  "elbowed": true,
  "roundness": null,
  "strokeWidth": 2,
  "strokeColor": "#868e96",
  "startArrowhead": null,
  "endArrowhead": "arrow",
  "lastCommittedPoint": null
}
```

### fixedPoint Quick Reference for Mind Maps

| Arrow Direction | Start fixedPoint | End fixedPoint |
|-----------------|------------------|----------------|
| Center → Right branch | `[1, 0.5]` | `[0, 0.5]` |
| Center → Left branch | `[0, 0.5]` | `[1, 0.5]` |
| Right branch → Sub-node | `[1, 0.5]` | `[0, 0.5]` |
| Left branch → Sub-node | `[0, 0.5]` | `[1, 0.5]` |

### Center → Branch Arrows (Radial)

**Right-side branches:**
```json
{
  "id": "arrow-center-to-branch1",
  "type": "arrow",
  "x": 1080,
  "y": 660,
  "width": 180,
  "height": -100,
  "elbowed": true,
  "roundness": null,
  "points": [[0, 0], [90, 0], [90, -100], [180, -100]],
  "startBinding": {
    "elementId": "center",
    "fixedPoint": [1, 0.5],
    "focus": 0,
    "gap": 5
  },
  "endBinding": {
    "elementId": "branch-1",
    "fixedPoint": [0, 0.5],
    "focus": 0,
    "gap": 5
  },
  "startArrowhead": null,
  "endArrowhead": "arrow",
  "lastCommittedPoint": null
}
```

**Left-side branches:**
```json
{
  "id": "arrow-center-to-branch4",
  "type": "arrow",
  "x": 840,
  "y": 660,
  "width": -180,
  "height": -50,
  "elbowed": true,
  "roundness": null,
  "points": [[0, 0], [-90, 0], [-90, -50], [-180, -50]],
  "startBinding": {
    "elementId": "center",
    "fixedPoint": [0, 0.5],
    "focus": 0,
    "gap": 5
  },
  "endBinding": {
    "elementId": "branch-4",
    "fixedPoint": [1, 0.5],
    "focus": 0,
    "gap": 5
  },
  "startArrowhead": null,
  "endArrowhead": "arrow",
  "lastCommittedPoint": null
}
```

### Branch → Sub-node Arrows

**Right-side sub-nodes (branch on left, sub-nodes extend right):**
```json
{
  "id": "arrow-branch1-to-sub1",
  "type": "arrow",
  "x": 1460,
  "y": 560,
  "width": 60,
  "height": -30,
  "elbowed": true,
  "roundness": null,
  "points": [[0, 0], [30, 0], [30, -30], [60, -30]],
  "startBinding": {
    "elementId": "branch-1",
    "fixedPoint": [1, 0.5],
    "focus": 0,
    "gap": 5
  },
  "endBinding": {
    "elementId": "sub-1-1",
    "fixedPoint": [0, 0.5],
    "focus": 0,
    "gap": 5
  },
  "startArrowhead": null,
  "endArrowhead": "arrow",
  "lastCommittedPoint": null
}
```

**Left-side sub-nodes (sub-nodes extend left from branch):**
```json
{
  "id": "arrow-branch4-to-sub1",
  "type": "arrow",
  "x": 500,
  "y": 610,
  "width": -60,
  "height": -20,
  "elbowed": true,
  "roundness": null,
  "points": [[0, 0], [-30, 0], [-30, -20], [-60, -20]],
  "startBinding": {
    "elementId": "branch-4",
    "fixedPoint": [0, 0.5],
    "focus": 0,
    "gap": 5
  },
  "endBinding": {
    "elementId": "sub-4-1",
    "fixedPoint": [1, 0.5],
    "focus": 0,
    "gap": 5
  },
  "startArrowhead": null,
  "endArrowhead": "arrow",
  "lastCommittedPoint": null
}
```

### Multiple Sub-nodes from One Branch

When a branch has multiple sub-nodes, offset the `fixedPoint.y` value to avoid overlapping:

| Sub-node Position | Right Branch fixedPoint | Left Branch fixedPoint |
|-------------------|-------------------------|------------------------|
| First (top) | `[1, 0.3]` | `[0, 0.3]` |
| Second (middle) | `[1, 0.5]` | `[0, 0.5]` |
| Third (bottom) | `[1, 0.7]` | `[0, 0.7]` |

This ensures arrows exit at different points on the branch edge.

### Arrow Stroke Colors by Branch

Match arrow color to branch theme (lighter shade):

| Branch | Arrow Stroke |
|--------|-------------|
| Branch 1 (blue) | `#74c0fc` |
| Branch 2 (green) | `#8ce99a` |
| Branch 3 (orange) | `#ffc078` |
| Branch 4 (purple) | `#b197fc` |
| Branch 5 (yellow) | `#ffe066` |
| Branch 6 (cyan) | `#66d9e8` |

Or use neutral gray `#868e96` for all arrows.

### Bidirectional Binding Reminder

**Every arrow must be referenced by BOTH connected shapes:**

```json
// Branch node
{
  "id": "branch-1",
  "boundElements": [
    { "id": "text-branch-1", "type": "text" },
    { "id": "arrow-center-to-branch1", "type": "arrow" },
    { "id": "arrow-branch1-to-sub1", "type": "arrow" },
    { "id": "arrow-branch1-to-sub2", "type": "arrow" }
  ]
}

// Sub-node
{
  "id": "sub-1-1",
  "boundElements": [
    { "id": "text-sub-1-1", "type": "text" },
    { "id": "arrow-branch1-to-sub1", "type": "arrow" }
  ]
}
```

### Arrow Validation Checklist

Before outputting mind map:
- [ ] Every main branch has an arrow FROM the center node
- [ ] Every sub-node has an arrow FROM its parent branch
- [ ] All arrows have `elbowed: true` and `roundness: null`
- [ ] Arrow positions start at the source shape's edge (not center)
- [ ] Both source AND target shapes include the arrow in `boundElements`
- [ ] `gap: 8` used for all bindings

---

## Example Layout Structure

For a "Morning Routine" mind map with 6 branches:

**Structure:**
- Central: "MORNING ROUTINE"
- Right side: Exercise, Meditation, Breakfast
- Left side: Journaling, Plan Day, Review Goals

**Each branch has 2-3 sub-nodes:**
- Exercise → "20 min cardio", "Stretching", "Hydrate"
- Meditation → "10 min breath focus", "Gratitude"
- etc.

**Result:** Balanced radial layout with sub-nodes extending outward from each branch, colors distinguishing different themes.

---

## Common Failure Modes

| Failure | Cause | Fix |
|---------|-------|-----|
| **Overlap** | Sub-nodes collide | Calculate cumulative Y from actual heights |
| **Off-canvas** | Too much content | Balance sides, reduce content |
| **Vertical stack** | All branches same X | Vary X position (radial spread) |
| **Text overflow** | Long text in small box | Increase width/height, or truncate |
| **Arrows crossing** | Wrong node order | Order branches correctly (clockwise) |

---

## Output

Save as: `[topic]-mindmap.excalidraw`

Example: `morning-routine-mindmap.excalidraw`

**Write-only rule:** Use the `Write` tool to save the JSON to
`work_products/<name>.excalidraw`. Do not paste JSON into chat.
